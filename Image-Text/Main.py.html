<html>
<head>
<title>Main.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #7a7e85;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Main.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">tkinter </span><span class="s0">as </span><span class="s1">tk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">filedialog</span><span class="s2">, </span><span class="s1">messagebox</span><span class="s2">, </span><span class="s1">scrolledtext</span><span class="s2">, </span><span class="s1">ttk</span>
<span class="s0">from </span><span class="s1">PIL </span><span class="s0">import </span><span class="s1">Image</span><span class="s2">, </span><span class="s1">ImageTk</span><span class="s2">, </span><span class="s1">ImageEnhance</span><span class="s2">, </span><span class="s1">ImageOps</span><span class="s2">, </span><span class="s1">ImageFilter</span>
<span class="s0">import </span><span class="s1">os</span>

<span class="s3"># --- Character Sets ---</span>
<span class="s3"># 1. Simple: Good for very small icons or high contrast</span>
<span class="s1">CHARS_SIMPLE </span><span class="s2">= [</span><span class="s4">'.'</span><span class="s2">, </span><span class="s4">':'</span><span class="s2">, </span><span class="s4">'*'</span><span class="s2">, </span><span class="s4">'#'</span><span class="s2">, </span><span class="s4">'@'</span><span class="s2">]</span>

<span class="s3"># 2. Standard: Balanced for most images</span>
<span class="s1">CHARS_STANDARD </span><span class="s2">= [</span><span class="s4">' '</span><span class="s2">, </span><span class="s4">'.'</span><span class="s2">, </span><span class="s4">':'</span><span class="s2">, </span><span class="s4">'-'</span><span class="s2">, </span><span class="s4">'='</span><span class="s2">, </span><span class="s4">'+'</span><span class="s2">, </span><span class="s4">'*'</span><span class="s2">, </span><span class="s4">'#'</span><span class="s2">, </span><span class="s4">'%'</span><span class="s2">, </span><span class="s4">'@'</span><span class="s2">]</span>

<span class="s3"># 3. High Detail: 70 characters for maximum detail (Standard ramp)</span>
<span class="s1">CHARS_HIGH </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\|()1{}[]?-_+~&lt;&gt;i!lI;:,</span><span class="s0">\&quot;</span><span class="s4">^`'. &quot;</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">AsciiArtGenerator</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">root</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root </span><span class="s2">= </span><span class="s1">root</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s4">&quot;ASCII Art Generator Pro&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">geometry</span><span class="s2">(</span><span class="s4">&quot;1000x750&quot;</span><span class="s2">)</span>

        <span class="s3"># Styles</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui </span><span class="s2">= (</span><span class="s4">&quot;Segoe UI&quot;</span><span class="s2">, </span><span class="s5">9</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">font_art </span><span class="s2">= (</span><span class="s4">&quot;Consolas&quot;</span><span class="s2">, </span><span class="s5">9</span><span class="s2">)  </span><span class="s3"># Monospaced font is strictly required</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">original_image </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s3"># --- Layout ---</span>
        <span class="s3"># 1. Top Control Panel</span>
        <span class="s1">control_frame </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LabelFrame</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Settings&quot;</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">control_frame</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">TOP</span><span class="s2">, </span><span class="s1">fill</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">X</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s3"># Row 1: Load &amp; Dimensions</span>
        <span class="s1">row1 </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">control_frame</span><span class="s2">)</span>
        <span class="s1">row1</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">fill</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">X</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_load </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Load Image&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">load_image</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#e0e0e0&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_load</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">15</span><span class="s2">))</span>

        <span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Width (chars):&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">).</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Height (lines):&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">).</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_height </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_height</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">lock_aspect </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">BooleanVar</span><span class="s2">(</span><span class="s1">value</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">chk_aspect </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Checkbutton</span><span class="s2">(</span><span class="s1">row1</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Lock Aspect Ratio (Fix Stretch)&quot;</span><span class="s2">, </span><span class="s1">variable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">lock_aspect</span><span class="s2">,</span>
                                         <span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">update_height_suggestion</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">chk_aspect</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s3"># Row 2: Detail &amp; Mode</span>
        <span class="s1">row2 </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">control_frame</span><span class="s2">)</span>
        <span class="s1">row2</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">fill</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">X</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">row2</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Detail Mode:&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">).</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">combo_mode </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Combobox</span><span class="s2">(</span><span class="s1">row2</span><span class="s2">,</span>
                                       <span class="s1">values</span><span class="s2">=[</span><span class="s4">&quot;High Detail (70 chars)&quot;</span><span class="s2">, </span><span class="s4">&quot;Standard (10 chars)&quot;</span><span class="s2">, </span><span class="s4">&quot;Simple (5 chars)&quot;</span><span class="s2">],</span>
                                       <span class="s1">state</span><span class="s2">=</span><span class="s4">&quot;readonly&quot;</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s5">20</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">combo_mode</span><span class="s2">.</span><span class="s1">current</span><span class="s2">(</span><span class="s5">1</span><span class="s2">)  </span><span class="s3"># Default to Standard</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">combo_mode</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">row2</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Contrast Boost:&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">).</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=(</span><span class="s5">15</span><span class="s2">, </span><span class="s5">0</span><span class="s2">))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scale_contrast </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Scale</span><span class="s2">(</span><span class="s1">row2</span><span class="s2">, </span><span class="s1">from_</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">to</span><span class="s2">=</span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">resolution</span><span class="s2">=</span><span class="s5">0.1</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">HORIZONTAL</span><span class="s2">, </span><span class="s1">length</span><span class="s2">=</span><span class="s5">100</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scale_contrast</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s5">1.5</span><span class="s2">)  </span><span class="s3"># Default 1.5x</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scale_contrast</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_convert </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">row2</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;GENERATE&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">generate_ascii</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#4CAF50&quot;</span><span class="s2">, </span><span class="s1">fg</span><span class="s2">=</span><span class="s4">&quot;white&quot;</span><span class="s2">,</span>
                                     <span class="s1">font</span><span class="s2">=(</span><span class="s4">&quot;Segoe UI&quot;</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s4">&quot;bold&quot;</span><span class="s2">), </span><span class="s1">width</span><span class="s2">=</span><span class="s5">15</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_convert</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">20</span><span class="s2">)</span>

        <span class="s3"># 2. Main Display Area</span>
        <span class="s1">paned </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">PanedWindow</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">HORIZONTAL</span><span class="s2">, </span><span class="s1">sashwidth</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#d9d9d9&quot;</span><span class="s2">)</span>
        <span class="s1">paned</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">fill</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s3"># Left: Preview</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">preview_frame </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">paned</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#f0f0f0&quot;</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s5">300</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">preview_label </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">preview_frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Image Preview&quot;</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#f0f0f0&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">preview_label</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">expand</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">paned</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">preview_frame</span><span class="s2">, </span><span class="s1">minsize</span><span class="s2">=</span><span class="s5">200</span><span class="s2">)</span>

        <span class="s3"># Right: Text Output</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">text_area </span><span class="s2">= </span><span class="s1">scrolledtext</span><span class="s2">.</span><span class="s1">ScrolledText</span><span class="s2">(</span><span class="s1">paned</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_art</span><span class="s2">, </span><span class="s1">undo</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
                                                   <span class="s1">wrap</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">NONE</span><span class="s2">)  </span><span class="s3"># No wrap to keep lines straight</span>
        <span class="s1">paned</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">text_area</span><span class="s2">, </span><span class="s1">minsize</span><span class="s2">=</span><span class="s5">400</span><span class="s2">)</span>

        <span class="s3"># 3. Bottom Bar</span>
        <span class="s1">bottom_frame </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>
        <span class="s1">bottom_frame</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">BOTTOM</span><span class="s2">, </span><span class="s1">fill</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">X</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_copy </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">bottom_frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Copy to Clipboard&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">copy_to_clipboard</span><span class="s2">, </span><span class="s1">bg</span><span class="s2">=</span><span class="s4">&quot;#2196F3&quot;</span><span class="s2">,</span>
                                  <span class="s1">fg</span><span class="s2">=</span><span class="s4">&quot;white&quot;</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">btn_copy</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">RIGHT</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">bottom_frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Ready&quot;</span><span class="s2">, </span><span class="s1">anchor</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">, </span><span class="s1">font</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">font_ui</span><span class="s2">, </span><span class="s1">fg</span><span class="s2">=</span><span class="s4">&quot;#666&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">LEFT</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">load_image</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">file_path </span><span class="s2">= </span><span class="s1">filedialog</span><span class="s2">.</span><span class="s1">askopenfilename</span><span class="s2">(</span>
            <span class="s1">title</span><span class="s2">=</span><span class="s4">&quot;Select Image&quot;</span><span class="s2">,</span>
            <span class="s1">filetypes</span><span class="s2">=[(</span><span class="s4">&quot;Images&quot;</span><span class="s2">, </span><span class="s4">&quot;*.png *.jpg *.jpeg *.bmp *.gif&quot;</span><span class="s2">), (</span><span class="s4">&quot;All Files&quot;</span><span class="s2">, </span><span class="s4">&quot;*.*&quot;</span><span class="s2">)]</span>
        <span class="s2">)</span>
        <span class="s0">if not </span><span class="s1">file_path</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">original_image </span><span class="s2">= </span><span class="s1">Image</span><span class="s2">.</span><span class="s1">open</span><span class="s2">(</span><span class="s1">file_path</span><span class="s2">)</span>

            <span class="s3"># Update Preview</span>
            <span class="s1">display_img </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">original_image</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
            <span class="s1">display_img</span><span class="s2">.</span><span class="s1">thumbnail</span><span class="s2">((</span><span class="s5">300</span><span class="s2">, </span><span class="s5">300</span><span class="s2">))</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">photo </span><span class="s2">= </span><span class="s1">ImageTk</span><span class="s2">.</span><span class="s1">PhotoImage</span><span class="s2">(</span><span class="s1">display_img</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">preview_label</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">image</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">photo</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;&quot;</span><span class="s2">)</span>

            <span class="s3"># Reset Width if empty or keep user setting</span>
            <span class="s0">if not </span><span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width</span><span class="s2">.</span><span class="s1">get</span><span class="s2">():</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s4">&quot;120&quot;</span><span class="s2">)</span>

            <span class="s1">self</span><span class="s2">.</span><span class="s1">update_height_suggestion</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s4">f&quot;Loaded: </span><span class="s0">{</span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">basename</span><span class="s2">(</span><span class="s1">file_path</span><span class="s2">)</span><span class="s0">}</span><span class="s4">&quot;</span><span class="s2">)</span>

        <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s4">&quot;Error&quot;</span><span class="s2">, </span><span class="s4">f&quot;Failed to load image: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s4">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">update_height_suggestion</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">if not </span><span class="s1">self</span><span class="s2">.</span><span class="s1">original_image </span><span class="s0">or not </span><span class="s1">self</span><span class="s2">.</span><span class="s1">lock_aspect</span><span class="s2">.</span><span class="s1">get</span><span class="s2">():</span>
            <span class="s0">return</span>

        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width</span><span class="s2">.</span><span class="s1">get</span><span class="s2">())</span>
            <span class="s1">img_w</span><span class="s2">, </span><span class="s1">img_h </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">original_image</span><span class="s2">.</span><span class="s1">size</span>
            <span class="s1">ratio </span><span class="s2">= </span><span class="s1">img_h </span><span class="s2">/ </span><span class="s1">img_w</span>
            <span class="s3"># Aspect Ratio Correction Factor (0.55 is standard for most fonts)</span>
            <span class="s1">h </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">w </span><span class="s2">* </span><span class="s1">ratio </span><span class="s2">* </span><span class="s5">0.55</span><span class="s2">)</span>
            <span class="s1">h </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">h</span><span class="s2">)</span>

            <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_height</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">entry_height</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">str</span><span class="s2">(</span><span class="s1">h</span><span class="s2">))</span>
        <span class="s0">except </span><span class="s1">ValueError</span><span class="s2">:</span>
            <span class="s0">pass</span>

    <span class="s0">def </span><span class="s1">get_char_set</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mode </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">combo_mode</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
        <span class="s0">if </span><span class="s4">&quot;High&quot; </span><span class="s0">in </span><span class="s1">mode</span><span class="s2">:</span>
            <span class="s3"># Need to reverse this list because user wants dark=@, light=.</span>
            <span class="s3"># The standard string &quot;$@...&quot; usually goes from Dark to Light.</span>
            <span class="s3"># So we keep it as is if 0=dark, 255=white.</span>
            <span class="s3"># Let's verify mapping logic later.</span>
            <span class="s0">return </span><span class="s1">CHARS_HIGH</span>
        <span class="s0">elif </span><span class="s4">&quot;Standard&quot; </span><span class="s0">in </span><span class="s1">mode</span><span class="s2">:</span>
            <span class="s0">return </span><span class="s1">CHARS_STANDARD</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s0">return </span><span class="s1">CHARS_SIMPLE</span>

    <span class="s0">def </span><span class="s1">generate_ascii</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">if not </span><span class="s1">self</span><span class="s2">.</span><span class="s1">original_image</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showwarning</span><span class="s2">(</span><span class="s4">&quot;Warning&quot;</span><span class="s2">, </span><span class="s4">&quot;Please load an image first.&quot;</span><span class="s2">)</span>
            <span class="s0">return</span>

        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">target_w </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">entry_width</span><span class="s2">.</span><span class="s1">get</span><span class="s2">())</span>
            <span class="s1">target_h </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">entry_height</span><span class="s2">.</span><span class="s1">get</span><span class="s2">())</span>
        <span class="s0">except </span><span class="s1">ValueError</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s4">&quot;Error&quot;</span><span class="s2">, </span><span class="s4">&quot;Width and Height must be integers.&quot;</span><span class="s2">)</span>
            <span class="s0">return</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Processing...&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">update</span><span class="s2">()</span>

        <span class="s3"># 1. Resize Image (using LANCZOS for quality)</span>
        <span class="s1">img </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">original_image</span><span class="s2">.</span><span class="s1">resize</span><span class="s2">((</span><span class="s1">target_w</span><span class="s2">, </span><span class="s1">target_h</span><span class="s2">), </span><span class="s1">Image</span><span class="s2">.</span><span class="s1">Resampling</span><span class="s2">.</span><span class="s1">LANCZOS</span><span class="s2">)</span>

        <span class="s3"># 2. Convert to Grayscale</span>
        <span class="s1">img </span><span class="s2">= </span><span class="s1">img</span><span class="s2">.</span><span class="s1">convert</span><span class="s2">(</span><span class="s4">&quot;L&quot;</span><span class="s2">)</span>

        <span class="s3"># 3. Enhance Quality</span>
        <span class="s3"># Auto-Contrast: Maximizes the difference between dark and light pixels</span>
        <span class="s1">img </span><span class="s2">= </span><span class="s1">ImageOps</span><span class="s2">.</span><span class="s1">autocontrast</span><span class="s2">(</span><span class="s1">img</span><span class="s2">)</span>

        <span class="s3"># Manual Contrast Boost</span>
        <span class="s1">contrast_val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">scale_contrast</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
        <span class="s1">enhancer </span><span class="s2">= </span><span class="s1">ImageEnhance</span><span class="s2">.</span><span class="s1">Contrast</span><span class="s2">(</span><span class="s1">img</span><span class="s2">)</span>
        <span class="s1">img </span><span class="s2">= </span><span class="s1">enhancer</span><span class="s2">.</span><span class="s1">enhance</span><span class="s2">(</span><span class="s1">contrast_val</span><span class="s2">)</span>

        <span class="s3"># Sharpen: Helps define edges at low resolution</span>
        <span class="s1">img </span><span class="s2">= </span><span class="s1">img</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">ImageFilter</span><span class="s2">.</span><span class="s1">SHARPEN</span><span class="s2">)</span>

        <span class="s3"># 4. Map Pixels to Characters</span>
        <span class="s1">chars </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">get_char_set</span><span class="s2">()</span>
        <span class="s1">pixels </span><span class="s2">= </span><span class="s1">img</span><span class="s2">.</span><span class="s1">getdata</span><span class="s2">()</span>
        <span class="s1">ascii_str </span><span class="s2">= </span><span class="s4">&quot;&quot;</span>

        <span class="s1">num_chars </span><span class="s2">= </span><span class="s1">len</span><span class="s2">(</span><span class="s1">chars</span><span class="s2">)</span>
        <span class="s1">range_width </span><span class="s2">= </span><span class="s5">255 </span><span class="s2">/ </span><span class="s1">num_chars</span>

        <span class="s0">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">pixel_val </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">pixels</span><span class="s2">):</span>
            <span class="s3"># Mapping logic:</span>
            <span class="s3"># If CHARS list is ['dark', ..., 'light']: index = pixel_val // range_width</span>
            <span class="s3"># If CHARS list is ['light', ..., 'dark']: index = (255 - pixel_val) // range_width</span>

            <span class="s3"># Check the definition of our lists:</span>
            <span class="s3"># CHARS_HIGH starts with '$' (Dark) -&gt; ends with ' ' (Light)</span>
            <span class="s3"># CHARS_SIMPLE starts with '.' (Light) -&gt; ends with '@' (Dark)</span>

            <span class="s1">mode </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">combo_mode</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

            <span class="s0">if </span><span class="s4">&quot;High&quot; </span><span class="s0">in </span><span class="s1">mode</span><span class="s2">:</span>
                <span class="s3"># High list is Dark -&gt; Light ($ ... space)</span>
                <span class="s3"># Pixel 0 (black) should be index 0 ($)</span>
                <span class="s3"># Pixel 255 (white) should be last index (space)</span>
                <span class="s1">index </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">pixel_val </span><span class="s2">/ </span><span class="s5">255 </span><span class="s2">* (</span><span class="s1">num_chars </span><span class="s2">- </span><span class="s5">1</span><span class="s2">))</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s3"># Simple/Standard lists are Light -&gt; Dark (. ... @)</span>
                <span class="s3"># Pixel 0 (black) should be last index (@)</span>
                <span class="s3"># Pixel 255 (white) should be first index (.)</span>
                <span class="s1">index </span><span class="s2">= </span><span class="s1">int</span><span class="s2">((</span><span class="s5">255 </span><span class="s2">- </span><span class="s1">pixel_val</span><span class="s2">) / </span><span class="s5">255 </span><span class="s2">* (</span><span class="s1">num_chars </span><span class="s2">- </span><span class="s5">1</span><span class="s2">))</span>

            <span class="s3"># Safety clamp</span>
            <span class="s1">index </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">min</span><span class="s2">(</span><span class="s1">index</span><span class="s2">, </span><span class="s1">num_chars </span><span class="s2">- </span><span class="s5">1</span><span class="s2">))</span>

            <span class="s1">ascii_str </span><span class="s2">+= </span><span class="s1">chars</span><span class="s2">[</span><span class="s1">index</span><span class="s2">]</span>

            <span class="s0">if </span><span class="s2">(</span><span class="s1">i </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">) % </span><span class="s1">target_w </span><span class="s2">== </span><span class="s5">0</span><span class="s2">:</span>
                <span class="s1">ascii_str </span><span class="s2">+= </span><span class="s4">&quot;</span><span class="s0">\n</span><span class="s4">&quot;</span>

        <span class="s3"># 5. Output</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">text_area</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">text_area</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s1">ascii_str</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s4">f&quot;Done! </span><span class="s0">{</span><span class="s1">target_w</span><span class="s0">}</span><span class="s4">x</span><span class="s0">{</span><span class="s1">target_h</span><span class="s0">} </span><span class="s4">chars.&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">copy_to_clipboard</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">content </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">text_area</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">)</span>
        <span class="s0">if not </span><span class="s1">content</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">():</span>
            <span class="s0">return</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">clipboard_clear</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">clipboard_append</span><span class="s2">(</span><span class="s1">content</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">status_label</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s4">&quot;Copied to clipboard!&quot;</span><span class="s2">)</span>


<span class="s0">if </span><span class="s1">__name__ </span><span class="s2">== </span><span class="s4">&quot;__main__&quot;</span><span class="s2">:</span>
    <span class="s1">root </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Tk</span><span class="s2">()</span>
    <span class="s1">app </span><span class="s2">= </span><span class="s1">AsciiArtGenerator</span><span class="s2">(</span><span class="s1">root</span><span class="s2">)</span>
    <span class="s1">root</span><span class="s2">.</span><span class="s1">mainloop</span><span class="s2">()</span></pre>
</body>
</html>